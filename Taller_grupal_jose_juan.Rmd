---
title: "Prueba Saber TyT 2016-2"
subtitle: "Análisis de rresultados"
author: "Institución Educando Líderes - Dpto. Estadísticas e información institucional"
date: "`r Sys.Date()`"
output:
  rmdformats::material:
    highlight: kate
    self_contained: true
    code_folding: hide
    thumbnails: true
    gallery: true
    fig_width: 4
    fig_height: 4
    df_print: kable
pkgdown:
  as_is: true    
---
```{r global_options, echo=FALSE}
knitr::opts_chunk$set(fig.path="", message=FALSE, warning=FALSE,
                      echo=FALSE, results="show", fig.width=11)
```
# Contexto 

![](logoIEL.jpg)

## El presente informe
Este es un informe de análisis de resultados del Examen Saber TyT, realizado por el departamento de estadísticas e información institucional de la Institución Educando Líderes, con el cual ofrecemos un panorama general del desempeño del país en el segundo periodo de 2016, desde la perspectiva de nuestra institución.

El informe está dirigido a la comunidad académica de interés tanto en lo concerniente a las conclusiones cómo a las diferentes etapas del proceso de análisis sobre los datos.

La primera etapa del proceso, cubierta en esa edición del informe, consiste en el aseguramiento de la calidad de los datos y, en consecuencia, de la adecuada preparación de los mismos a fin de suministrar un adecuado set de datos para que el análisis de los resultados pueda llevarse a cabo en una segunda etapa. 


## El examen {.tabset .tabset-fade .tabset-pills}

El pasado 9 de septiembre de 2016, el Icfes realizó el Examen de Estado de la Calidad de la Educación Superior, Saber TyT.  
De acuerdo con la página oficial  (_[link](https://www.icfes.gov.co/web/guest/acerca-del-examen-saber-tyt)_), la prueba está dirigida a la siguiente población:

### Estudiantes de últimos semestres de programas académicos Técnicos y Tecnológicos
La prueba está dirigida a estudiantes que han aprobado el 75% de los créditos de sus respectivos programas técnicos profesionales y tecnológicos.

### Población en condición de discapacidad

La prueba aplica para población con las siguientes discapacidades:

|Tipo de discapacidad                               |
|---------------------------------------------------|-
|Discapacidad física - movilidad                    |
|Discapacidad auditiva - usuario del castellano     |
|Discapacidad visual - baja visión irreversible     |
|Discapacidad visual - ceguera                      |
|Sordoceguera                                       |
|Trastorno permanente de la voz y el habla          |
|Discapacidad intelectual                           |
|Discapacidad mental/psicosocial                    |
|Trastorno del espectro autista                     |
|Trastorno del espectro autista - asperger          |
|Discapacidad sistémica                             |

### Reclusos
La prueba aplica para población privada de la libertad, siendo esta presentada en su sitio de reclusión respectivo

### Etnias
Las siguientes son las categorías étnicas que han sido contempladas para la clasificación de los aplicantes a la prueba.

|Etnias                     |     -                     |
|---------------------------|---------------------------|
|Arhuaco                    |Pasto                      |
|Cancuamo                   |Pijao                      |
|Comunidad Afrodescendiente |Raizal o Palenquero        |
|Comunidad Rom (gitana)     |Sikuani                    |
|Cubeo                      |Tucano                     |
|Embera                     |Wayúu                      |
|Guambiano                  |Zenú                       |
|Huitoto                    |Ninguno                    |
|Inga                       |Otro                       |
|Paez                       |                           |


```{r Packages and functions, echo=FALSE, message=FALSE, warning=FALSE}
library(readxl)
library(reshape2)
library(dplyr)
library(e1071)
library(Hmisc)
library(inspectdf) #este no lo tienen
library(funModeling) #este no lo tienen
library(VIM) #este no lo tienen
library(stringr)
library(xtable) #este no lo tienen
library(ggplot2)
library(directlabels)
library(scales)
library(ggthemes)
library(mice)
library(BBmisc)

descriptivas<- function(x){data.frame("MEDIDA"=c("Observaciones", "Mínimo", "1er Q", "Media", "Mediana", "Desv Est", "3er Q", "Máximo", "Asimetría", "Curtosis", "atípico leve<", "atípico leve>","atípico extremo<","atípico extremo>", "Err Est Media", "IC(95%) Media Up", "IC(95%) Media Down"),"VALOR"=format(c(length(na.omit(x)), min(na.omit(x)), quantile(na.omit(x), prob=0.25), mean(na.omit(x)), median(na.omit(x)), sd(na.omit(x)), quantile(na.omit(x), prob=0.75), max(na.omit(x)), skewness(na.omit(x)), kurtosis(na.omit(x)), (2.5*quantile(na.omit(x),prob=0.25)-1.5*quantile(na.omit(x), prob=0.75)),(2.5*quantile(na.omit(x),prob=0.75)-1.5*quantile(na.omit(x), prob=0.25)),(4*quantile(na.omit(x),prob=0.25)-3*quantile(na.omit(x), prob=0.75)),(4*quantile(na.omit(x),prob=0.75)-3*quantile(na.omit(x), prob=0.25)), ((sd(na.omit(x))/sqrt(length(na.omit(x))))), (mean(na.omit(x))+1.96*(sd(na.omit(x))/sqrt(length(na.omit(x))))), (mean(na.omit(x))-1.96*((sd(na.omit(x))/sqrt(length(na.omit(x))))))), scientific = F))}
#FUNCIÓN PARA ESTADÍSTICAS DESCRIPTIVAS PARA VARIABLES CONTINUAS

descriptivas2<-function(Continua,Categorias){
  x1=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){length(na.omit(x))})
  names(x1)=c("Categoría","Obs")
  x2=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){min(na.omit(x))})
  names(x2)=c("Categoría","Mínimo")
  x3=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){quantile(na.omit(x), prob =0.25)})
  names(x3)=c("Categoría","1er Q")
  x4=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){median(na.omit(x))})
  names(x4)=c("Categoría","Mediana")
  x5=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){mean(na.omit(x))})
  names(x5)=c("Categoría","Media")
  x6=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){quantile(na.omit(x), prob =0.75)})
  names(x6)=c("Categoría","3er Q")
  x7=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){max(na.omit(x))})
  names(x7)=c("Categoría","Máximo")
  x8=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){sd(na.omit(x))})
  names(x8)=c("Categoría","Desv Est")
  x9=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){skewness(na.omit(x))})
  names(x9)=c("Categoría","Asimetría")
  x10=aggregate.data.frame(Continua, by=list(Categorias), FUN=function(x){kurtosis(na.omit(x))})
  names(x10)=c("Categoría","Curtosis")
  cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9,x10)[,-seq(3,19,2)]
}
#FUNCIÓN PARA ESTADÍSTICAS DESCRIPTIVAS PARA VARIABLES CONTINUAS EN SUBMUESTRAS
  
tabla_freq<- function(x,total=1,na="ifany"){
  if (total==1) {
    M=data.frame("Categoria"=table(x, useNA = na), "Rel"=prop.table(table(x,useNA = na)))[,-3]
    names(M)=c("Categoria","Freq. Abs.","Freq. Rel.")
    M$Categoria=as.character(M$Categoria)
    M[nrow(M)+1,]=c("Total",sum(M$`Freq. Abs.`),sum(M$`Freq. Rel.`))
    M$`Freq. Rel.`=as.numeric(M$`Freq. Rel.`)
    M$`Freq. Abs.`=as.numeric(M$`Freq. Abs.`)
    M
  } else{
    M=data.frame("Categoria"=table(x, useNA = na), "Rel"=prop.table(table(x,useNA = na)))[,-3]
    names(M)=c("Categoria","Freq. Abs.","Freq. Rel.")
    M
  }
}
#FUNCIÓN PARA ESTADÍSTICAS DESCRIPTIVAS PARA VAR DISCRETAS

tabla_freq2<-function(x,y,na="ifany",prop=0, suma=c("filas","col")){
  if (prop==0) {
    M=as.data.frame.matrix(table(x, y, useNA = na))
    M$Categoria=row.names(M)
    rownames(M)=NULL
    M=M[,c(ncol(M),1:ncol(M)-1)]
    M$Categoria=as.character(M$Categoria)
    M[nrow(M)+1,]=c("Total",colSums(M[,2:ncol(M)]))
    M[,2:ncol(M)]=sapply(M[,2:ncol(M)], as.numeric)
    M$Total=rowSums(M[,2:ncol(M)])
    M
  } else if (prop==1 & suma=="filas") {
    M=as.data.frame.matrix(table(x, y, useNA = na))
    M$Categoria=row.names(M)
    rownames(M)=NULL
    M=M[,c(ncol(M),1:ncol(M)-1)]
    M$Categoria=as.character(M$Categoria)
    M[nrow(M)+1,]=c("Total",colSums(M[,2:ncol(M)]))
    M[,2:ncol(M)]=sapply(M[,2:ncol(M)], as.numeric)
    M$Total=rowSums(M[,2:ncol(M)])
    for (i in 2:ncol(M)) {
      M[,i]=M[,i]/M[,ncol(M)]
    }
    M
  } else {
    M=as.data.frame.matrix(table(x, y, useNA = na))
    M$Categoria=row.names(M)
    rownames(M)=NULL
    M=M[,c(ncol(M),1:ncol(M)-1)]
    M$Categoria=as.character(M$Categoria)
    M[nrow(M)+1,]=c("Total",colSums(M[,2:ncol(M)]))
    M[,2:ncol(M)]=sapply(M[,2:ncol(M)], as.numeric)
    M$Total=rowSums(M[,2:ncol(M)])
    for (i in 1:nrow(M)) {
      M[i,2:ncol(M)]=M[i,2:ncol(M)]/M[nrow(M),2:ncol(M)]
    }
    M 
  }
}
```

# Los Datos 

## Carga inicial de la base de datos

La base de datos sobre la cual realizaremos el análisis fue provista por el Icfes en formato CSV.  
Archivo: "SABERTYT20162.csv".

```{r echo=FALSE}
setwd("./")
base= read.csv(file='SABERTYT20162.csv', encoding="latin1", header= TRUE, sep=';', na.strings = c("NA",""))
str(base)
```

## Identificación de la estructura de los datos para el análisis

Después de analizar la estructura de la base de datos, determinamos:

* De las 104 columnas disponibles,  las características que serán relevantes para este análisis corresponden con las columnas 1 a la 15 y las columnas 85 a 104.  
* Trabajar sobre los registros de resultados cuyo estado indica que son registros listos para publicar (ESTADO "PUBLICAR") 
* Analizar los registros correspondientes a los estudiantes de nacionalidad colombiana (PAIS COLOMBIA*).

La base de datos final sobre la cual realizar el análisis es:

```{r echo=FALSE}
base= base[,c(1:15,85:104)]
base= base[base$ESTU_ESTADO == "PUBLICAR",]
base= base[base$ESTU_NACIONALIDAD == "1 COLOMBIA",]
str(base)
```

> En la validación del dato de nacionalidad pudimos observar que se incluye tanto el código como el nombre del país en el mismo campo, sin embargo, no se observa inconsistencia alguna respecto a este dato, ya que los demás paises están almacenados de manera consistente bajo la estructura "código nombre". 

# Análisis de calidad de los datos

Cómo parte del proceso, nos ocupamos de realizar algunos análisis particulares que compartimos a continuación. 

## Exploración de inconsistencias

### Prueba de niveles de inglés {.tabset .tabset-fade .tabset-pills}

Los niveles de inglés, según el Icfes, son en orden ascendente de acuerdo con el nivel de desempeño:

1. A1-
2. A1
3. A2
4. B1
5. B2 

En vista de que, según el Ministerio de Educación Nacional, una institución de educación superior tiene la meta de llevar a sus estudiantes a nivel B1 o B2, realizamos una revisión de los datos para identificar el volumen de estudiantes que cumplen o no con esta condición.

```{r nivel de ingles, echo=FALSE, message=FALSE}
base$MOD_INGLES_DESEM= factor(base$MOD_INGLES_DESEM, levels=c("A1-","A1","A2","B1","B2"))
### creamos una nueva Variable (meta_ingles_cumplida)
base$meta_ingles_cumplida = ifelse(base$MOD_INGLES_DESEM == "B1" | base$MOD_INGLES_DESEM == "B2", "SI", "NO")
base$meta_ingles_cumplida = factor(base$meta_ingles_cumplida)
tabla_freq(base$meta_ingles_cumplida)
```
> Tabla de frecuencia cumplimiento nivel de inglés

Pudimos comprobar que el 13.98% efectivamente cumple con el nivel de inglés esperado.  *No se observan anomalías, a partir del caso.*

### Edad de los estudiantes {.tabset .tabset-fade .tabset-pills}

Agregamos una variable relativa a la edad del estudiante al momento de presentar la prueba, a fin de realizar la caracterización.  

```{r echo=FALSE}
base$edad = round(as.numeric(difftime(as.Date("9/09/2016", format="%d/%m/%Y"),as.Date(base$ESTU_FECHANACIMIENTO, format="%d/%m/%Y"), units = "weeks"))/52.17857, digits = 2)
```

Producto de ello, encontramos algunas edades negativas o cero, que nos conducen a concluir una anomalía en las fechas de nacimiento de la base de datos:

```{r echo=FALSE}
### Revisar las fechas de nacimiento atípicas por cálculo negativo
tabla_freq(base$edad<=1)

edades_imposibles = base[base$edad <= 1,]
```
> Tabla de frecuencia registros con edades negativas o cero

![](Edades2019.jpg)

> Caracterización de referencia edades inscritos a las pruebas Saber TyT.

Adicionalmente, de acuerdo con el gráfico anterior, la prueba está caracterizada por el icfes para una población que supera los 15 años, lo cual nos hace suponer que los 22 registros (0,04%)  que indican edades menores a los 15 años, corresponden a anomalías que deben ser verificadas en la fuente y serán incluidas en nuestro informe final. 

```{r echo=FALSE}
rangos_edad = base[base$edad>=1, c("ESTU_FECHANACIMIENTO","edad")]
rangos_edad = rangos_edad[!is.na(rangos_edad$edad),]
rangos_edad$rango_edad = cut(rangos_edad$edad, breaks = c(0, 14.5, 21, 28, 50, 99),
    labels = c("0-14", "15-20", "21-27", "28-50", "Mas de 50"))
tabla_freq(rangos_edad$rango_edad)
ggplot(rangos_edad, aes(x=rango_edad, y=(..count..)/sum(..count..)))+
  geom_bar(fill="steelblue", color="black")+
  labs(x="Rango Edad",y="Frecuencia")+
  scale_y_continuous(limits = c(0,0.5), breaks = seq(0,0.5,0.05), labels=percent)+
  geom_text(aes(label=percent((..count..)/sum(..count..))), stat='count',vjust=-0.5, fontface = "bold", size=3)+
  theme_base()

```

> Distribución de rangos de edades en la prueba

Estos 22 registros sumados a los 52 (0,10%) registros descartados por valores negativos o cero en el cálculo de la edad, representan tan solo el 0,14% de la muestra.

# Comprobación de anomalías {.tabset .tabset-fade .tabset-pills}

Con las anomalías detectadas, procedemos a construir un derecho de petición para dirigirlo al Icfes e informarlas, a fin de solicitar además la información que nos permita dar solución a estos problemas.



# Análisis de resultados

Finalizada la etapa de aseguramiento de la calidad de los datos, hemos iniciado el desarrollo de la actividad de análisis.  Una vez finalice, los resultados serán publicados en este apartado del informe.